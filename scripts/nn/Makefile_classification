DATE := $(shell date +%Y%m%d)
DIR=../../processed_data/combined

# define genome splits
split:
	python define_genome_splits.py 0.75 4639675 \
	$(DIR)/tss_scramble_peak_expression_model_format.txt \
	$(DIR)/tss_scramble_peak_expression_model_format.txt \
	--classification --neg_threshold 0.75 --pos_threshold 1.25

# create 6-mer counts feature file for random forest
kmer: 
	@ Rscript create_kmer_counts.R \
	$(DIR)/tss_scramble_peak_expression_model_format_train_genome_split_classification.txt \
	$(DIR)/tss_scramble_peak_expression_model_format_train_genome_split_classification_kmer_counts.txt
	@ Rscript create_kmer_counts.R \
	$(DIR)/tss_scramble_peak_expression_model_format_test_genome_split_classification.txt \
	$(DIR)/tss_scramble_peak_expression_model_format_test_genome_split_classification_kmer_counts.txt

# runs best on GPUs
nn: 
	python dragonn_hyperparameter_tuning.py \
	$(DIR)/tss_scramble_peak_expression_model_format_train_genome_split_classification.txt \
	$(DIR)/tss_scramble_peak_expression_model_format_test_genome_split_classification.txt \
	150 3 5 100 0.2 100 \
	$(DIR)/$(DATE)_tss_scramble_peak_classification_hyperparam_tuned > \
	$(DIR)/$(DATE)_tss_scramble_peak_classification_hyperparam_tuned.log


rf_kmer: 
	python random_forest.py \
	$(DIR)/tss_scramble_peak_expression_model_format_train_genome_split_classification_kmer_counts.txt \
	$(DIR)/tss_scramble_peak_expression_model_format_test_genome_split_classification_kmer_counts.txt \
	$(DIR)/$(DATE)_rf_tss_scramble_peak_classification_predictions.txt --classification


rf_onehot:
	python random_forest.py \
	$(DIR)/tss_scramble_peak_expression_model_format_train_genome_split_classification.txt \
	$(DIR)/tss_scramble_peak_expression_model_format_test_genome_split_classification.txt \
	$(DIR)/$(DATE)_rf_onehot_tss_scramble_peak_classification_predictions.txt \
	--onehot --seq_length 150 --classification

print-%  : ; @echo $* = $($*)
